<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 	
	<mapper namespace="com.ezen.project.model.DisplayHotelMapper">

	<!-- 호텔검색결과 -->
	<select parameterType="java.util.Map" resultType="HotelDTO" id="searchHotel">
		${sql}
	</select>
	
	<!-- 호텔 후기 갯수 -->
	<select resultType="int" id="reviewCount">
		select count(*) from project_review where h_num = #{h_num}
	</select>
	
	<!-- 호텔별점 -->
	<select resultType="int" id="reviewStar">
		select review_star from project_review where h_num = #{h_num}
	</select>
	
	<!-- 호텔상세 호텔 -->
	<select parameterType="int" resultType="HotelDTO" id="hotelDetail">
		select * from project_hotel where h_num = #{h_num}
	</select>
	
	<!-- 호텔상세 방 -->
	<select parameterType="java.util.Map" resultType="RoomDTO" id="roomDetail">
		select * from project_room where h_num=#{h_num} and room_type=#{type}
	</select>
	
	<!-- 위시리스트 추가 -->
	<insert parameterType="java.util.Map" id="addWish">
		insert into project_wishlist values(project_wishlist_seq.nextval,#{u_num}, #{h_num}, 'Y', #{review_num})
	</insert>
	
	<!-- 위시리스트 체크여부 -->
	<select parameterType="java.util.Map" resultType="String" id="checkWish">
		select w_check from project_wishlist where h_num=#{h_num} and u_num=#{u_num}
	</select>
	
	<!-- 해당 호텔의 리뷰 모두 꺼내오기 -->
	<select parameterType="int" resultType="ReviewDTO" id="reviewList">
		select * from project_review where h_num=#{h_num}
	</select>
	
	<!-- 예약정보 저장 -->
	<insert parameterType="java.util.Map" id="addBooking">
		insert into project_booking values(project_booking_seq.nextval,
		#{room_num},#{h_num},#{u_num},#{book_indate},#{book_outdate},
		sysdate, #{book_payment}, #{book_usepoint}, #{book_totalprice},#{book_savepoint}, 
		'wait', #{book_name}, #{book_tel}) 
	</insert>
	
	<!-- 예약상세보기 -->
	<select parameterType="java.util.Map" resultType="BookingDTO" id="showBooking">
		select * from project_booking where h_num=#{h_num} and u_num=#{u_num} and room_num=#{room_num} 
	</select>
	
	<!-- 위시리스트 삭제 -->
	<delete parameterType="java.util.Map" id="deleteWish">
		delete table project_wishlist where w_num=#{w_num} and u_num=#{u_num}
	</delete>
	
	<!-- 회원정보 -->
	<select resultType="UserDTO" id="userInfo">
		select * from project_useraccount where u_num=#{u_num}
	</select>
	
	<!-- 예약정보 -->
	<select parameterType="java.util.Map" resultType="BookingDTO" id="bookInfo1">
		select * from project_booking where book_num=#{book_num}
	</select>
	
	<select parameterType="java.util.Map" resultType="BookingDTO" id="bookInfo2">
		select * from project_booking where u_num=#{u_num} and h_num=#{h_num}
	</select>

</mapper>